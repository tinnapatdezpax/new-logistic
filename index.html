<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Upload XLSX</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .drop-area {
      border: 2px dashed #888; padding: 40px; text-align: center;
      color: #666; border-radius: 10px; margin-top: 20px;
    }
    .drop-area.dragover {
      background: #f0f8ff;
      border-color: #00f;
    }
  </style>
</head>
<body>
  <h2>üì¶ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô (.xlsx)</h2>
  <p>‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå .xlsx ‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</p>

  <div class="drop-area" id="drop-area">Drop or Click to Upload .xlsx</div>
  <p id="status"></p>

  <script>
    const dropArea = document.getElementById("drop-area");
    const statusText = document.getElementById("status");

    const scriptURL = "https://script.google.com/macros/s/AKfycbx7HMCra4q9ywi2Ywvmg7XzMOBGKY_2GR3afbpjhJKB0gRa6siq7HK9i6Kw3WR2T5nJ/exec"; // <== ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ

    dropArea.addEventListener("click", () => {
      const input = document.createElement("input");
      input.type = "file";
      input.accept = ".xlsx";
      input.onchange = () => uploadFile(input.files[0]);
      input.click();
    });

    dropArea.addEventListener("dragover", e => {
      e.preventDefault();
      dropArea.classList.add("dragover");
    });

    dropArea.addEventListener("dragleave", () => {
      dropArea.classList.remove("dragover");
    });

    dropArea.addEventListener("drop", e => {
      e.preventDefault();
      dropArea.classList.remove("dragover");
      const file = e.dataTransfer.files[0];
      if (file && file.name.endsWith(".xlsx")) {
        uploadFile(file);
      } else {
        statusText.innerText = "‚ùå ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå .xlsx ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô";
      }
    });

    function uploadFile(file) {
      statusText.innerText = "üì§ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î...";
      const reader = new FileReader();
      reader.onload = () => {
        fetch(scriptURL, {
          method: "POST",
          body: JSON.stringify({ file: reader.result }),
          headers: { "Content-Type": "application/json" }
        })
        .then(res => res.json())
        .then(data => {
          if (data.status === "success") {
            statusText.innerText = `‚úÖ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (${data.rows} ‡πÅ‡∏ñ‡∏ß)`;
          } else {
            statusText.innerText = `‚ùå ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${data.message}`;
          }
        })
        .catch(err => {
          statusText.innerText = `‚ùå Error: ${err}`;
        });
      };
      reader.readAsDataURL(file);
    }
  </script>
</body>
</html>


